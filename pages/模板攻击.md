- 前提：能耗依赖于正在处理的数据
- 使用[[多元正态分布]]对能量迹特征刻画，由特征刻画和实施攻击两部分构成
- 攻击者可以确定某些指令序列的模板$(m,C)$
	- 攻击者持有与被攻击设备相同的设备，利用该设备对不同数据$d_i$和密钥$k_j$执行特定指令序列并记录能耗信息，与$(d_i,k_j)$对应迹分组，估计多元正态分布的均值向量和协方差矩阵，得到模板$h_{d_i,k_j}=(m,C)_{d_i,k_j}$
	- 从被攻击设备获得能量迹计算多元正态分布的概率密度函数[[多元高斯模型]]
		- $p(t;(\textbf{m,C})_{d_i,k_j})=\frac{exp(-\frac{1}{2}*(\textbf{t-m})^{'}*\textbf{C}^{-1}*(\textbf{t-m})}{\sqrt{(2\pi)^T*det(\textbf{C})}}$
	- 计算对于不同模板的概率$p(t;(\textbf{m,C})_{d_i,k_j})$，正确模板与概率最高相对应
	- 若所有密钥等概分布，对应[[极大似然判定准则]]
- [[模板构建]]策略
	- 选取特征点$N_{IP}$的策略，特征点是包含关于所刻画指令最多信息的点
	- 数据和密钥对模板构建
		- 模板特征点是能量迹中与密钥对$(d_i,k_j)$相关的所有点(涉及$(d_i,k_j),d_i,k_j$的所有指令都会产生特征点)
	- 中间值模板构建
		- 为某些适当函数$f(d_i,k_j)$构建模板
	- 基于能量模型的模板构建
		- 如果设备泄漏了数据汉明重量的信息，则可创建有关汉明重量的模板
	- 构建AES软件实现的模板一般采用基于能量模型方法，如果设备仅泄漏汉明重量则不能从一条能量迹中利用该方法获得密钥
- [[模板匹配]]
	- 原理上就是计算概率，匹配最大概率的过程
	- 为避免指数运算，通常对式子[[取对数]],概率对数绝对值最小的模板揭示正确密钥
		- $\ln{p(t;(\textbf{m,C})_{d_i,k_j})}=-\frac{1}{2}\big((\textbf{t-m})^{'}*\textbf{C}^{-1}*(\textbf{t-m})+\ln{((2\pi)^{N_{IP}}*det(\textbf{C}))}\big)$
	- 为避免协方差矩阵求逆遇到数值问题，用单位矩阵代替协方差矩阵
		- $\ln{p(t;\textbf{m})}=-\frac{1}{2}\big((\textbf{t-m})^{'}(\textbf{t-m})+\ln{((2\pi)^{N_{IP}})}\big)$
		- 使用简化模板([[最小二乘法]])，判定准则简化为$(\textbf{t-m}_{d_i,k_j})^{'}(\textbf{t-m}_{d_i,k_j})<(\textbf{t-m}_{d_i,k_l})^{'}(\textbf{t-m}_{d_i,k_l})$