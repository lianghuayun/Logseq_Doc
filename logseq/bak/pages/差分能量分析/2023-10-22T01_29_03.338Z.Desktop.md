- 攻击目标是大量不同分组数据加密解密操作的能量迹
- 一般性攻击策略
	- 1.选择执行算法的某中间值$f(d,k)$
	- 2.测量能耗
		- 攻击者需要知道相应的$\textbf{d}=(d_1,...,d_D)^{'}$，$d_i$表示第i次加密或解密对应操作值
		- 对应数据分组$d_i$的能量迹记$\textbf{t}_i^{'}=(t_{i,1},...,t_{i,T})$，T表示能量迹长度
		- 这些能量迹可记作大小为$D*T$的矩阵$\textbf{T}$，正确对齐能量迹尤为重要
	- 3.计算假设中间值
		- 对于每一个可能的k值计算假设中间值，这些可能得值记$\textbf{k}=(k_1,...,k_K)$,K示可能值的数量
		- $\textbf{k}=(k_1,...,k_K)$中各元素值称[[密钥假设]]
		- 由D次加密和K个密钥假设$\textbf{d}，\textbf{k}$计算假设中间值$f(d,k)$可得到大小为$D*K$的矩阵$\textbf{V}$
			- $v_{i,j}=f(d_i,k_j)$    $i=1,...,D,j=1,...K$.
			- ![image.png](../assets/image_1697682389591_0.png){:height 152, :width 188}
			- DPA攻击的目标是找出设备在D次加密或解密运行期间处理的是V的哪一列，从而确定密钥$k_{ck}$
	- 4.中间值映射为能耗
		- ![image.png](../assets/image_1697682528995_0.png){:height 154, :width 249}
		- [[能量仿真]]质量的优劣主要依赖于攻击者对被攻击设备的了解程度，[[能量模型]]刻画越精细，所需能量迹越小
	- 5.比较假设能耗值和能量迹
		- ![image.png](../assets/image_1697684471484_0.png){:height 125, :width 225}
		- 对比$\textbf{H}$和$\textbf{T}$每一列得到大小为$K*T$的矩阵$\textbf{R}$
			- 对比所用算法特性：$r_{i,j}$值越大，$h_i$和$t_j$匹配度越高
				- 基于[[相关系数]]
				- 硬件实现相比软件实现的加密操作，相关系数会小
			- 第1步的中间值中，设备实际固定密钥操作得到的是$\textbf{v}_{ck}$,是$\textbf{V}$的一列，能量迹中依赖中间值的位置构成$\textbf{t}_{ct}$,是$\textbf{T}$的一列
			- 基于$\textbf{v}_{ck}$仿真的假设能耗$\textbf{h}_{ck}$，和$\textbf{t}_{ct}$强相关从而使得$\textbf{R}$中最大值出现，从而索引出正确密钥
			- $\textbf{R}$中所有值大致相同的原因通常是能量迹不够多
- 相关系数的估值技术，无须实施实际的攻击
	- 基于能量迹$j$位置处的SNR计算$h_i$与$t_j$之间的相关性
		- $\rho(H_i,P_{total})=\frac{\rho(H_i,P_{exp})}{\sqrt{1+\frac{1}{SNR}}}$
- 能量迹数量估算
	-